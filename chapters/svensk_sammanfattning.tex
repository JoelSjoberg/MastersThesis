\title{Svensk Sammanfattning}

Gliom är en typ av cancer som formas i hjärnan från gliacellerna. Tumörer som konsekvent formas av sjukdomens effekt kategoriseras av Världshälsoorganisationen (på engelska "\textit{World Health Organization}") genom olika grader som beskriver hastigheten med vilken cancern sprids, samt dess aggressivitet. Cancerns effekt på gliompatienterna kan variera avsevärt mellan huvudvärk, illamående eller komplikationer gällande hjärnans funktion (t.ex. förvirring, problem med att prata och kommunicera och epileptiska anfall). En patient som diagnostiseras med gliom har ett fåtal år kvar att leva, det är ovanligt att patienter överlever i mera än fem år \cite{glialcells, gallego2015nonsurgical, bleeker2012recent}. Diagnoseringsprocessen inkluderar ett ingrepp, där sampel av tumören extraheras från patienten. Samplen analyseras sedan i labbet för att undersöka tumörens grad och bestämma den optimala medicinska kuren. Denna analys, följande samplets extrahering, kan räcka ett obestämt antal veckor. I denna avhandling beskrivs en analytisk process där vi analyserar Ramanspektra extraherat från gliomtumörer, tagna från 45 patienter. Från vissa patienter har flera sampel av samma tumör tagits, vilket ger ett större antal sampel än patienter. Analysens syfte är att förbereda alla spektra för användning i maskininlärningsmetoder. Detta innebär att alla sampel måste analyseras för att ta bort de spektra som inte kommer från tumörmaterial. Det är sannolikt att en delmängd av alla spektra från ett givet sampel kan ha kommit från t.ex. blod, plast som reflekteras under tunna bitar av samplet och nekrotiska celler.

Ramanspektroskopi används pga. den information som finns i varje spektra samt dess användning i tidigare projekt med maskininlärning \cite{ramanDL, ho2019rapid}. Ett spektrum består av $1738$ olika frekvenser; en del av analysen undersöker vilka av dessa frekvenser som bäst delar in alla spektra i olika kategorier. Kategorierna är baserade på olika sorter av mutationer i IDH-generna. Dessa kategorier har identifierats av Ceccarelli et al. \cite{cellsubsets} och påstås vara ett bättre sätt att identifiera en bra medicinsk kur, än de grader som för tillfället används. De frekvenser som bäst delar in alla spektra i kategorierna beräknas före och sedan efter att spektra från icke-tumörmaterial har separerats från tumörspektra.

\section*{Analys}

Analysen börjar med att avlägsna vissa sampel som visar sig vara problematiska att analysera. Två sampel avlägsnas, ett sampel från patient HF-1887 innehåller spektra som ligger på en kurvad grundlinje, vilket innebär att värdet på frekvenserna stiger stegvis från den första frekvensen till den sista. Ett högt värde på en frekvens indikerar information från punkten där spektrumet är taget. Då grundlinjen inte är rak blir det omöjligt att jämföra olika frekvenser i spektrumet. Alla sampel från patient HF-3097 har en konsistent grundlinje med alla andra sampel, men det finns ett betydligt större antal av frekvenser med enorma värden jämfört med andra sampel. Vi väljer att avlägsna alla sampel från patient HF-3097, eftersom den enorma mängden höga frekvenser i alla spektra tyder på att spektrometern har gett felaktiga värden.

Vi fortsätter genom att balansera datamängden enligt kategorierna som vi vill separera alla spektra i. Det finns en stor variation mellan antalet spektra tillhörande varje kategori. Vi delar in alla sampel i olika datamängder som kan ska användas i maskininlärning. Dessa är träningsmängden, valideringsmängden och testmängden. Eftersom det finns en risk för att tumörerna är heterogena, bestämmer vi att dela in dessa mängder enligt sampel, dvs. åtminstone ett unikt sampel från varje kategori finns i varje datamängd. Maskininlärningsmodeller måste kunna lära sig dela in ett spektrum i den kategori spektrumet tillhör genom att träna på träningsmängden. Om detta steg ignoreras och olika spektra från samma sampel används för att träna och validera modellen, kommer resultatet inte vara trovärdigt om alla tumörer är heterogena. Efter mängdseparationerna kan vi balansera träningsmängden genom att beräkna antalet spektra tillhörande varje kategori i mängden. Antalet spektra i träningsmängden tillhörande kategori $n$ kan då beskrivas genom $|LGm_n|$. Varje kategori balanseras genom att kopiera varje spektrum i en kategori $x$ gånger, då $x$ är resultatet av divisionen mellan antalet element i kategorin som utgör majoriteten i mängden och antalet spektra i kategori $n$. Detta beräknas enligt $x = \lfloor \frac{|LGm_m|}{|LGm_n|} \rfloor$ där $\lfloor$ och $\rfloor$ antyder avrundning nedåt av kvoten. De frekvenser som bäst beskriver samplets kategori beräknas sedan genom användning av \textit{f-classif-metoden} i SKlearn biblioteket i Python \cite{scikit}.

För att identifiera icke-tumörspektra testar vi olika metoder. Dessa metoder är standardavvikelsetestet, kvartilavståndet och oövervakade inlärningsmetoder som \textit{hierkisk klustring} och \textit{K-means-klustring}. Dessa metoder jämförs med frekvenskriteriet, vilket är ett kriterium baserat på frekvenserna $1463$ till $1473$ på alla spektra. Om någon av dessa frekvenser är under $5000$ på ett spektrum, är det spektrumet från ett icke-tumörmaterial. Standardavvikelsetestet och kvartilavståndet ger liknande resultat på majoriteten av sampel. Av dessa två är det kvartilavståndet som ger resultat liknande vad frekvenskriteriet ger. \textit{K-means-klustring} lyckas ge resultat som stämmer med frekvenskriteriet, algoritmen lyckas även hitta andra regioner på samplet som frekvenskriteriet inte hittar. Denna analys utförs genom att initialisera sex modeller som delar in samplet i två, tre, fyra, fem, sex och sju kluster. Mellan alla dessa finns det inte ett klart bästa alternativ för att identifiera icke-tumörspektra i varje sampel. Med \textit{hierarkisk klustrings} undersöker vi olika länkningskriterier som finns implementerade i SKlearn. Dessa är \textit{single-koppling}, \textit{average-koppling}, \textit{complete-koppling} och \textit{ward-koppling}. Av dessa kriterier, är det \textit{ward-koppling} som producerar bäst resultat. Dessa resultat är jämförbara med frekvens kriteriets resultat och de resultat som \textit{K-means-klustring} uppnår. Metoden är också konsistent och kan hitta alla icke-tumörspektra i majoriteten av sampel med tre kluster. I vissa sampel där antalet icke-tumör spektra är oansenligt behövs det fyra kluster eller mera.

\subsection*{Användning av datan}

Vi väljer att separera icke-tumörspektra från tumörspektra genom att använda \textit{ward linkage} med \textit{hierarchical clustering} algoritmen. Alla spektra går nu igenom en förberedande process som maskininlärnings modeller kräver. Grundlinjen på alla spektra tas bort genom \textit{ZhangFit} metoden i Python. Alla frekvenser i varje spektra är sedan standardiserade genom att subtrahera varje enskild frekvens med den frekvensens medeltal, differensen divideras sedan med standardavvikelsen för den frekvensen. Alla frekvenser normaliseras sedan genom att dividera varje enskild frekvens i varje spektra med det maximala absolutbelopp för den frekvensen. För att testa datans användbarhet efter den förberedande processen, skapar vi ett djupt neuralt nätverk för att klassificera alla spektra enligt deras respektive kategorier Ceccarelli et al. \cite{cellsubsets} presenterat. Modellens arkitektur beskrivs och dess prestanda presenteras. 

\subsection*{Slutsats}

Flera test på olika modellarkitekturer tyder på att arkitektur inte har en betydande inverkan på modellens prestanda, förutsagt att arkitekturen är djup nog. Modellen misslyckas klassificera alla spektra och har en tendens att föredra vissa kategorier över andra. Vi ger förslag för hur de processer vi använt kan förbättras i hopp om att kunna hitta en bättre modell i framtida studier. Dessa förslag är alternativ som inte avsetts under analysens utförande. Exempel på dessa är att använda alternativa metoder för att avlägsna grundlinjen samt förbättring av den analytiska metoden för att identifiera icke-tumörspektra genom att avsee klustrens avstånd från varandra. En klar förbättring på modellens prestanda är att samla mera sampel från gliompatienter i framtiden, men denna process är inte önskvärd pga. tiden som krävs för att samla dessa sampel samt behovet av lidande patienter.